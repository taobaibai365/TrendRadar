# TrendRadar 需求文档

本文档记录 TrendRadar 项目的所有功能需求和非功能需求。

---

## 📋 目录

- [功能需求](#功能需求)
- [非功能需求](#非功能需求)
- [用户需求](#用户需求)

---

## 🎯 功能需求

### 数据源管理

**优先级**：高
**状态**：✅ 已实现

**用户需求**：
> "所有信息源都要通过 Obsidian 前端界面进行配置"

**功能描述**：
- 支持 RSS 订阅
- 支持 Twitter/X 用户追踪
- 支持本地目录文件
- 通过前端界面管理所有数据源
- 支持添加、编辑、删除数据源

**验收标准**：
- [x] 用户可以通过 Obsidian 设置界面管理数据源
- [x] 支持至少 3 种数据源类型（RSS、Twitter、本地目录）
- [x] 数据源配置保存在配置文件中
- [x] 删除操作立即生效

**相关设计**：[[DESIGN.md#数据源分组架构]]
**相关变更**：[[CHANGELOG.md#2026-01-11]]

---

### 数据源分组

**优先级**：高
**状态**：✅ 已实现

**用户需求**：
> "我之所以考虑混合模式，是因为后续数据源的部分我可能会扩充（比如允许用户指定的多个目录中新增或有更新的文件或文件内容，每个目录用途可能不一样，例如'inbox'目录是用户自己随手从网上导入的文章，这些文章其实可以与订阅 rss 数据源等网络信息源放到一起进行统一分析，而另外一个目录'某某项目'不可以与网络信息源放到一起，且大模型也需要用本地部署或公司私有部署的。"

**功能描述**：
- 支持创建数据源分组
- 每个分组可以包含多个数据源
- 每个分组可以使用不同的 AI 配置
- 支持分组隔离（不同分组独立分析）
- 支持混合模式（网络源和本地源混合）

**验收标准**：
- [x] 用户可以创建、编辑、删除分组
- [x] 分组可以选择 AI 服务
- [x] 分组可以包含多个数据源
- [x] 不同分组使用独立的 AI 配置

**相关设计**：[[DESIGN.md#数据源分组架构]]
**相关变更**：[[CHANGELOG.md#2026-01-10]]

---

### AI 服务管理

**优先级**：高
**状态**：✅ 已实现

**用户需求**：
> "配置流程应该是：先配置 可用的 AI 服务列表，再配置数据源分组，在数据源分组中选择已有的 AI 服务、数据源"

**功能描述**：
- 支持配置多个 AI 服务
- 支持 OpenAI、DeepSeek、Gemini 等
- 支持本地/私有部署 AI（兼容 OpenAI API）
- AI 服务可以跨分组复用
- 支持分阶段处理（分析阶段 + 聚合阶段）

**验收标准**：
- [x] 用户可以添加、编辑、删除 AI 服务
- [x] 支持 AI 服务预设（OpenAI、DeepSeek、Gemini）
- [x] 支持自定义 API 地址（本地部署）
- [x] 支持分阶段模式选择
- [x] 分组可以选择已配置的 AI 服务

**相关设计**：[[DESIGN.md#AI服务架构]]
**相关变更**：[[CHANGELOG.md#2026-01-11]]

---

### 抓取失败内容处理

**优先级**：中
**状态**：✅ 已实现

**用户需求**：
> "对于只获取到了标题而无法全文抓取失败的，我建议对于此类的内容不参与 AI 分析，最后直接汇聚生成一个统一的卡片，展示链接就行，卡片名称也可以固定下来，当然去重还是要做的"

**功能描述**：
- 自动检测抓取失败的内容
- 失败内容不参与 AI 分析
- 生成统一的"今日链接汇总"卡片
- URL 去重
- 按源分组

**验收标准**：
- [x] 抓取失败的内容被标记
- [x] 失败内容不参与 AI 分析
- [x] 生成汇总卡片
- [x] URL 去重
- [x] 按数据源分组显示

**相关设计**：[[DESIGN.md#内容处理流程]]
**相关变更**：[[CHANGELOG.md#2026-01-10]]

---

### 防止并发抓取

**优先级**：中
**状态**：✅ 已实现

**用户需求**：
> "当后台开始抓取和处理数据时，前台的按钮就算点击也没有反应；如果在一个数据处理周期时，又来了一个触发数据抓取和处理的请求，则应该忽略这个请求，确保只有一个数据批次在处理中，因为这个项目的目标也不需要那么高频。"

**功能描述**：
- 后台检查抓取状态，拒绝并发请求
- 前端按钮状态实时更新
- 显示当前抓取状态
- 自动状态刷新（每 5 秒）

**验收标准**：
- [x] 同一时间只有一个抓取任务运行
- [x] 按钮在运行中时禁用
- [x] 显示当前状态（空闲/运行中）
- [x] 提供清晰的用户反馈

**相关设计**：[[DESIGN.md#并发控制]]
**相关变更**：[[CHANGELOG.md#2026-01-11]]

---

## 🔧 非功能需求

### 安全性

**优先级**：高
**状态**：✅ 已处理

**需求描述**：
- API token 等敏感信息不应提交到代码仓库
- 配置文件应在 .gitignore 中
- 支持环境变量配置

**验收标准**：
- [x] 敏感配置文件已添加到 .gitignore
- [x] 从 git 历史中移除敏感信息
- [x] 提供用户指导

**相关错误**：[[mistake.md#API-Token泄露]]

---

### 用户体验

**优先级**：高
**状态**：✅ 持续改进

**需求描述**：
- 界面简洁、紧凑，符合 Apple 设计风格
- 操作反馈清晰
- 防止误操作
- 配置流程逻辑清晰

**验收标准**：
- [x] Apple 风格的界面设计
- [x] 每个操作都有明确反馈
- [x] 危险操作有确认提示
- [x] Tab 顺序符合使用流程

**相关设计**：[[DESIGN.md#UI设计]]
**相关变更**：[[CHANGELOG.md#UI优化]]

---

### 可维护性

**优先级**：中
**状态**：✅ 已实现

**需求描述**：
- 代码结构清晰
- 文档完整
- 修改记录完整

**验收标准**：
- [x] 代码遵循现有架构
- [x] 有完整的文档体系
- [x] 每次变更都有 CHANGELOG

---

### 性能

**优先级**：低
**状态**：⏳ 待优化

**需求描述**：
- 响应时间合理
- 不影响 Obsidian 性能
- 抓取不影响界面操作

**验收标准**：
- [ ] 界面操作响应时间 < 100ms
- [ ] 抓取任务不阻塞界面
- [ ] 大量数据时界面流畅

---

## 📅 更新记录

### 2026-01-11
- 创建 requirements.md
- 添加了功能需求和非功能需求
- 建立了与 DESIGN.md 和 CHANGELOG.md 的双链关系

---

*本文档随项目发展持续更新中*
